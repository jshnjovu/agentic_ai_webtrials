[tool:pytest]
# Fast pytest configuration for UnifiedAnalyzer + DomainAnalysis integration tests

# Test discovery - focus only on our new test file
testpaths = tests/unit/test_services
python_files = test_unified_domain_integration.py
python_classes = TestUnifiedDomainIntegration
python_functions = test_*

# Markers
markers =
    fast: Fast tests that should run quickly
    integration: Integration tests using real APIs
    real_api: Tests that make real external API calls
    domain: Tests related to domain analysis functionality

# Test execution - optimized for speed
addopts = 
    -v
    -s
    --tb=short
    --strict-markers
    --disable-warnings
    --maxfail=5
    --durations=10
    --durations-min=0.1

# Filtering
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::UserWarning
    ignore::RuntimeWarning

# Coverage (minimal for speed)
addopts = 
    -v
    -s
    --tb=short
    --strict-markers
    --disable-warnings
    --maxfail=5
    --durations=10
    --durations-min=0.1
    --cov=src.services.unified
    --cov=src.services.domain_analysis
    --cov-report=term-missing
    --cov-fail-under=70

# Test output
console_output_style = classic

# Timeout - shorter for fast tests
timeout = 120

# Parallel execution - enable for speed
addopts = 
    -v
    -s
    --tb=short
    --strict-markers
    --disable-warnings
    --maxfail=5
    --durations=10
    --durations-min=0.1
    --cov=src.services.unified
    --cov=src.services.domain_analysis
    --cov-report=term-missing
    --cov-fail-under=70
    -n auto

# Logging - minimal for speed
log_cli = false
log_cli_level = WARNING
log_cli_format = %(levelname)s: %(message)s

# Environment variables for testing
env =
    PYTHONPATH = {toxinidir}
    TESTING = true
    LOG_LEVEL = WARNING
    UNIFIED_ANALYZER_TEST_MODE = true
    FAST_TEST_MODE = true

# Test selection - run only fast tests by default
addopts = 
    -v
    -s
    --tb=short
    --strict-markers
    --disable-warnings
    --maxfail=5
    --durations=10
    --durations-min=0.1
    --cov=src.services.unified
    --cov=src.services.domain_analysis
    --cov-report=term-missing
    --cov-fail-under=70
    -n auto
    -m "fast"
